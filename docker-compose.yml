version: '3.7'
services:
  client:
    build:
      context: ./client
      dockerfile: ./Dockerfile.develop
    tty: true
    stdin_open: true
    volumes:
      - ./client:/usr/app
    environment:
      - REACT_APP_ENDPOINT_URL=http://localhost:3001
    ports:
      - '3000:3000'
  api:
    build:
      context: ./server
      dockerfile: ./Dockerfile.develop
    tty: true
    stdin_open: true
    volumes:
      - ./server:/usr/app
    environment:
      - TZ=Asia/Tokyo
      - MONGO_URL=mongodb://react-user:passw0rd@mongo:27017/react-sample
    ports:
      - '3001:3001'
  mongo:
    image: mongo
    restart: always
    environment:
      MONGO_INITDB_DATABASE: react-sample
      MONGO_INITDB_ROOT_USERNAME: root
      MONGO_INITDB_ROOT_PASSWORD: example
      PORT: 3001
    ports:
      - 27017:27017
    volumes:
      - ./docker_configs/db/init.js:/docker-entrypoint-initdb.d/mongo-init.js:ro